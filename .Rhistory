stat_pvalue_manual(joined_df, label = "p.adj.signif", y.position = "y.position",hide.ns = TRUE,step.increase = 0.2,bracket.nudge.y = -0.5) +
labs(title = "Alterations in tryptophan metabolism") +
theme(
axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(),plot.background = element_rect(fill = "transparent",colour = NA)
) +
scale_color_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic")) +
scale_fill_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic"))
print(four4)
ggsave(file=here("paper/Figures/4.png"),plot=four4, dpi = 1000,width = 20, height = 30, units = "cm")
joined_df <- sta_lst_sig
joined_df <- subset(joined_df, variable%in%aas)
vg <- log_df1[log_df1$variable %in% joined_df$variable, ]
colnames(vg) <- c("rowname","Label","variable","log2 Concentration")
vg$Label <- factor(vg$Label, levels=c("1","10","8"))
maxim_val <- apply(df_norm_lab4[, which(colnames(df_norm_lab4)%in%aas)], 2, max)
maxim_val <- maxim_val
joined_df$y.position <- c(sapply(maxim_val, function(x) rep(x,3)))
four4 <- ggboxplot(vg, x = "Label", y = "log2 Concentration", color = "Label", facet.by = "variable", fill = "Label", alpha=0.4) + geom_point(aes(color = vg$Label)) +
facet_wrap(~ variable, scales = "free", ncol = 4) +
stat_pvalue_manual(joined_df, label = "p.adj.signif", y.position = "y.position",hide.ns = TRUE,step.increase = 0.2) +
labs(title = "Other amino acid alterations") +
theme(
axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(),plot.background = element_rect(fill = "transparent",colour = NA)
) +
scale_color_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic")) +
scale_fill_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic"))
print(four4)
ggsave(file=here("paper/Figures/4B.png"),plot=four4, dpi = 1000,width = 30, height = 20, units = "cm")
#
# filtered_pathways <- lapply(all_pathways, function(x) if ("map02010" %in% x) x)
# filtered_pathways <- filtered_pathways[!sapply(filtered_pathways, is.null)]
#
# trnsp <- subset(background, KEGG %in% names(filtered_pathways))$Query
# trnsp <- trnsp[!trnsp%in%amin]
#
# joined_df <- join_all(sta_lst_sig[c("Hyperglutamatergic","Hypoglutamatergic")], by="group2", type = "full")
# joined_df <- subset(joined_df, variable%in%trnsp)
# maxim_val <- apply(df_norm_lab4[, which(colnames(df_norm_lab4)%in%trnsp)], 2, max)
# vg <- log_df1[log_df1$variable %in% joined_df$variable, ]
# colnames(vg) <- c("rowname","Label","variable","log2 Concentration")
# pg <- ggboxplot(vg, x = "Label", y = "log2 Concentration", fill = "Label", facet.by = "variable") + geom_point() +
#   facet_wrap(~ variable, scales = "free", ncol = 4) +
#   stat_pvalue_manual(joined_df, label = "p.adj.signif", y = maxim_val-0.01, step.increase = 0.01) +
#   labs(title = "Alterations in other substrates of ABC transporters") +
# theme(
# axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank()
# ) +
#    scale_fill_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic"))
# print(pg)
vip_p <- vip_g
sels_r <- vip_p$Hyperglutamatergic$Metabolite[vip_p$Hyperglutamatergic$p.adj < 0.05 | vip_p$Hyperglutamatergic$VIP > 1]
sels_g <- vip_p$Hypoglutamatergic$Metabolite[vip_p$Hypoglutamatergic$p.adj < 0.05 | vip_p$Hypoglutamatergic$VIP > 1]
# comp_meds <- median_values_t[median_values_t$variable%in%amin,]
# aa_comp <- pivot_wider(data = comp_meds, names_from = Label, values_from = value)
# colnames(aa_comp) <- c("Metabolite","Control","Hypoglutamatergic","Hyperglutamatergic")
vip_p <- vip_g
vip_p$`Hyperglutamatergic`$diffexpressed <- "None"
vip_p$`Hyperglutamatergic`$diffexpressed[vip_p$`Hyperglutamatergic`$VIP >= 1] <- "MVA"
vip_p$`Hyperglutamatergic`$diffexpressed[vip_p$`Hyperglutamatergic`$p.adj < 0.05] <- "UVA"
vip_p$`Hyperglutamatergic`$diffexpressed[vip_p$`Hyperglutamatergic`$p.adj < 0.05 & vip_p$`Hyperglutamatergic`$VIP > 1] <- "UVA+MVA"
vip_p$`Hyperglutamatergic`$diffexpressed <- factor(vip_p$`Hyperglutamatergic`$diffexpressed, levels = c("UVA+MVA", "MVA", "UVA", "None"))
vip_p$Hypoglutamatergic$diffexpressed <- "None"
vip_p$Hypoglutamatergic$diffexpressed[vip_p$Hypoglutamatergic$VIP >= 1] <- "MVA"
vip_p$Hypoglutamatergic$diffexpressed[vip_p$Hypoglutamatergic$p.adj < 0.05] <- "UVA"
vip_p$Hypoglutamatergic$diffexpressed[vip_p$Hypoglutamatergic$p.adj < 0.05 & vip_p$Hypoglutamatergic$VIP >= 1] <- "UVA+MVA"
vip_p$Hypoglutamatergic$diffexpressed <- factor(vip_p$Hypoglutamatergic$diffexpressed, levels = c("UVA+MVA", "MVA", "UVA", "None"))
col_op <- c("#B25D91", "#FF3F38","#95C65C")
names(col_op) <- c("Hyperglutamatergic","Hypoglutamatergic", "Control")
two_e <- ggplot(data =  vip_p$Hypoglutamatergic, aes(x = p.adj, y = VIP, label=Metabolite, col=diffexpressed)) +
geom_vline(xintercept = 0.05, col = "darkgray", linetype = 'dashed') +
geom_hline(yintercept = 1, col = "darkgray", linetype = 'dashed') +
geom_point(size = 3) +
# geom_text_repel(aes(label=ifelse(vip_p$Hypoglutamatergic$p.adj < 0.05,as.character(vip_p$Hypoglutamatergic$Metabolite),'')),max.overlaps = 15) +
scale_color_manual(values = c("#9900F0", "#FF00E4", "#38E54D","grey"), # to set the colors of our variable
labels = c("UVA+MVA", "MVA", "UVA", "None"), breaks = levels(vip_p$Hypoglutamatergic$diffexpressed)) +
theme_light() +
# coord_cartesian(ylim = c(0, 3.5), xlim = c(0, 3.5)) +
labs(color = 'Altered', #legend_title,
x = "p-value", y = "VIP score", title=NULL) +
theme(legend.position = "bottom") +
xlim(c(0,1))
two_f <- ggplot(data=vip_p$`Hyperglutamatergic` ,aes(x = p.adj, y = VIP,  label=Metabolite,col=diffexpressed)) +
geom_vline(xintercept = 0.05, col = "darkgray", linetype = 'dashed') +
geom_hline(yintercept = 1, col = "darkgray", linetype = 'dashed') +
geom_point(size = 3) +
# geom_text_repel(aes(label=ifelse(vip_p$`Hyperglutamatergic`$p.adj < 0.05,as.character(vip_p$`Hyperglutamatergic`$Metabolite),'')),max.overlaps = 15) +
scale_color_manual(values = c("#9900F0","#FF00E4","#38E54D",  "grey"), # to set the colours of our variable
labels = c("UVA+MVA", "MVA", "UVA", "None"), breaks = levels(vip_p$`Hyperglutamatergic`$diffexpressed)) +
theme_light() +
# coord_cartesian(ylim = c(0, 3.5), xlim = c(0, 3.5)) +
labs(color = 'Altered',
x = "p-value", y = "VIP score", title=NULL) +
theme(legend.position = "bottom")
ggsave(file=here("paper/Figures/2C.jpeg"),plot=two_e)
ggsave(file=here("paper/Figures/2D.jpeg"),plot=two_f)
vip_g2 <- vip_g$Hyperglutamatergic[order(vip_g$Hyperglutamatergic$VIP, decreasing = TRUE),]
vip_g2 <- subset(vip_g2, VIP > 1)
vip_g2$color <- factor(names(vip_g[1]),levels=c("Hyperglutamatergic","Hypoglutamatergic"))
two_c <- vip_g2 %>%
filter(!is.na(VIP)) %>%
arrange(VIP) %>%
mutate(Metabolite = factor(Metabolite, Metabolite)) %>%
ggplot(aes(x = Metabolite, y = VIP, size = 1, fill = color)) +
geom_col() +
coord_flip() +
theme_bw(base_size = 12) +
xlab("") +
ylab("VIP scores") +
ylim(0, 4) +
guides(size = "none") +
scale_fill_manual(values = col_op[1], labels = "Hyperglutamatergic") +
theme(legend.title=element_blank(),legend.position = "bottom")
vip_g2 <- vip_g$`Hypoglutamatergic`[order(vip_g$`Hypoglutamatergic`$VIP, decreasing = TRUE),]
vip_g2 <- subset(vip_g2, VIP > 1)
vip_g2$color <- factor(names(vip_g[2]),levels=c("Hyperglutamatergic","Hypoglutamatergic"))
two_d <- vip_g2 %>%
filter(!is.na(VIP)) %>%
arrange(VIP) %>%
mutate(Metabolite = factor(Metabolite, Metabolite)) %>%
ggplot(aes(x = Metabolite, y = VIP, size = 1, fill = color)) +
geom_col() +
coord_flip() +
theme_bw(base_size = 12) +
xlab("") +
ylab("VIP scores") +
ylim(0, 4) +
guides(size = "none") +
scale_fill_manual(values = col_op[2], labels = "Hypoglutamatergic") +
theme(legend.title=element_blank(),legend.position = "bottom") +
scale_x_discrete(position = "top")
patchvip <- two_c + two_d + plot_layout(guides = "collect") & theme(legend.position = "right", plot.background = element_rect(fill = "transparent",colour = NA), legend.background = element_rect(fill = "transparent",colour = NA))
ggsave(file=here("paper/Figures/vip.png"),patchvip,dpi = 1000, scale = 1, bg="transparent",width = 30, height = 12, units = "cm")
df_metg <- df_norm_lab4
df_metg <- subset(df_metg,Label%in%c(1,10))
df_metg <- data.frame(t(df_metg),check.names = FALSE)
df_metg <- row_to_names(df_metg,1)
mat_allg <- as.matrix(df_metg)
lab <- data.frame(as.factor(mat_allg[1,]))
lab$as.factor.mat_allg.1.... <- gsub(10,"Hyperglutamatergic     ",lab$as.factor.mat_allg.1....)
lab$as.factor.mat_allg.1.... <- gsub(1,"Control",lab$as.factor.mat_allg.1....)
colnames(lab)<-"Label"
# lab$Label<- factor(lab$Label,levels = c("Control","Hyperglutamatergic","Hypoglutamatergic"),ordered = TRUE)
lab$Label<- factor(lab$Label,levels = c("Control","Hyperglutamatergic     "),ordered = TRUE)
mat_allg <- apply(mat_allg[-1,],c(1,2),as.numeric)
# lc <- c("#95C65C","#B25D91","#FF3F38")
# names(lc) <-  levels(lab$Label)
# lc <- list(Label = lc)
lc <- c("#95C65C","#B25D91")
names(lc) <-  levels(lab$Label)
lc <- list(Label = lc)
p6 <- pheatmap(mat_allg, annotation = lab,clustering_method = "ward.D2",fontsize = 10,show_colnames = TRUE,show_rownames = FALSE, border_color = NA, annotation_colors = lc, fontsize_col = 10, color = colorRampPalette(c("blue","red"))(100), cluster_rows = TRUE,scale = "row",legend = TRUE, annotation_legend = TRUE, cellwidth = 10, cellheight = 2)
p6 <- wrap_elements(as.grob(p6))
df_metg <- df_norm_lab4
df_metg <- subset(df_metg,Label%in%c(1,8))
df_metg <- row_to_names(df_metg,1)df_metg <- data.frame(t(df_metg),check.names = FALSE)
?ggsave
tryp_mets <- c(
"Kynurenic acid",
"Kynurenine",
"3-Hydroxyanthranilic acid",
"Tryptophan",
"Anthranilic acid",
"5-Hydroxyindole-3-acetic acid",
"N-Acetyl-5-hydroxytryptamine",
"2-Picolinic acid",
"Trigonelline",
"Indole-3-propionic acid"
)
aas <- c(
"Glutamic acid",
"Proline",
"Serine",
"Threonine",
"Valine",
"Alanine",
"Aspartic acid",
"Glycine",
"Isoleucine",
"Leucine",
"Phenylalanine")
lcp4 <- c("#95C65C","#B25D91","#FF3F38")
# joined_df <- join_all(sta_lst_sig[c("Hyperglutamatergic","Hypoglutamatergic")], by="group2", type = "full")
joined_df <- sta_lst_sig
joined_df <- subset(joined_df, variable%in%tryp_mets)
vg <- log_df1[log_df1$variable %in% joined_df$variable, ]
colnames(vg) <- c("rowname","Label","variable","log2 Concentration")
vg$Label <- factor(vg$Label, levels=c("1","10","8"))
maxim_val <- apply(df_norm_lab4[, which(colnames(df_norm_lab4)%in%tryp_mets)], 2, max)
maxim_val <- maxim_val + 0.5
joined_df$y.position <- c(sapply(maxim_val, function(x) rep(x,3)))
four4 <- ggboxplot(vg, x = "Label", y = "log2 Concentration", color = "Label", facet.by = "variable", fill = "Label", alpha=0.4) + geom_point(aes(color = vg$Label)) +
facet_wrap(~ variable, scales = "free", ncol = 3) +
stat_pvalue_manual(joined_df, label = "p.adj.signif", y.position = "y.position",hide.ns = TRUE,step.increase = 0.2,bracket.nudge.y = -0.5) +
labs(title = "Alterations in tryptophan metabolism") +
theme(
axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(),plot.background = element_rect(fill = "transparent",colour = NA)
) +
scale_color_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic")) +
scale_fill_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic"))
print(four4)
ggsave(file=here("paper/Figures/4.png"),plot=four4, dpi = 1000,width = 20, height = 30, units = "cm")
ggsave(file=here("paper/Figures/4.png"),plot=four4, dpi = 1000,bg="white" ,width = 20, height = 30, units = "cm")
tryp_mets <- c(
"Kynurenic acid",
"Kynurenine",
"3-Hydroxyanthranilic acid",
"Tryptophan",
"Anthranilic acid",
"5-Hydroxyindole-3-acetic acid",
"N-Acetyl-5-hydroxytryptamine",
"2-Picolinic acid",
"Trigonelline",
"Indole-3-propionic acid"
)
aas <- c(
"Glutamic acid",
"Proline",
"Serine",
"Threonine",
"Valine",
"Alanine",
"Aspartic acid",
"Glycine",
"Isoleucine",
"Leucine",
"Phenylalanine")
lcp4 <- c("#95C65C","#B25D91","#FF3F38")
# joined_df <- join_all(sta_lst_sig[c("Hyperglutamatergic","Hypoglutamatergic")], by="group2", type = "full")
joined_df <- sta_lst_sig
joined_df <- subset(joined_df, variable%in%tryp_mets)
vg <- log_df1[log_df1$variable %in% joined_df$variable, ]
colnames(vg) <- c("rowname","Label","variable","log2 Concentration")
vg$Label <- factor(vg$Label, levels=c("1","10","8"))
maxim_val <- apply(df_norm_lab4[, which(colnames(df_norm_lab4)%in%tryp_mets)], 2, max)
maxim_val <- maxim_val + 0.5
joined_df$y.position <- c(sapply(maxim_val, function(x) rep(x,3)))
four4 <- ggboxplot(vg, x = "Label", y = "log2 Concentration", color = "Label", facet.by = "variable", fill = "Label", alpha=0.4) + geom_point(aes(color = vg$Label)) +
facet_wrap(~ variable, scales = "free", ncol = 4) +
stat_pvalue_manual(joined_df, label = "p.adj.signif", y.position = "y.position",hide.ns = TRUE,step.increase = 0.2,bracket.nudge.y = -0.5) +
labs(title = "Alterations in tryptophan metabolism") +
theme(
axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(),plot.background = element_rect(fill = "transparent",colour = NA)
) +
scale_color_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic")) +
scale_fill_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic"))
print(four4)
ggsave(file=here("paper/Figures/4.png"),plot=four4, dpi = 1000,bg="white" ,width = 30, height = 30, units = "cm")
tryp_mets <- c(
"Kynurenic acid",
"Kynurenine",
"3-Hydroxyanthranilic acid",
"Tryptophan",
"Anthranilic acid",
"5-Hydroxyindole-3-acetic acid",
"N-Acetyl-5-hydroxytryptamine",
"2-Picolinic acid",
"Trigonelline",
"Indole-3-propionic acid"
)
aas <- c(
"Glutamic acid",
"Proline",
"Serine",
"Threonine",
"Valine",
"Alanine",
"Aspartic acid",
"Glycine",
"Isoleucine",
"Leucine",
"Phenylalanine")
lcp4 <- c("#95C65C","#B25D91","#FF3F38")
# joined_df <- join_all(sta_lst_sig[c("Hyperglutamatergic","Hypoglutamatergic")], by="group2", type = "full")
joined_df <- sta_lst_sig
joined_df <- subset(joined_df, variable%in%tryp_mets)
vg <- log_df1[log_df1$variable %in% joined_df$variable, ]
colnames(vg) <- c("rowname","Label","variable","log2 Concentration")
vg$Label <- factor(vg$Label, levels=c("1","10","8"))
maxim_val <- apply(df_norm_lab4[, which(colnames(df_norm_lab4)%in%tryp_mets)], 2, max)
maxim_val <- maxim_val + 0.5
joined_df$y.position <- c(sapply(maxim_val, function(x) rep(x,3)))
four4 <- ggboxplot(vg, x = "Label", y = "log2 Concentration", color = "Label", facet.by = "variable", fill = "Label", alpha=0.4) + geom_point(aes(color = vg$Label)) +
facet_wrap(~ variable, scales = "free", ncol = 4) +
stat_pvalue_manual(joined_df, label = "p.adj.signif", y.position = "y.position",hide.ns = TRUE,step.increase = 0.2,bracket.nudge.y = -0.5) +
labs(title = "Alterations in tryptophan metabolism") +
theme(
axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(),plot.background = element_rect(fill = "transparent",colour = NA)
) +
scale_color_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic")) +
scale_fill_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic"))
print(four4)
ggsave(file=here("paper/Figures/4.png"),plot=four4, dpi = 1000,bg="white" ,width = 30, height = 20, units = "cm")
tryp_mets <- c(
"Kynurenic acid",
"Kynurenine",
"3-Hydroxyanthranilic acid",
"Tryptophan",
"Anthranilic acid",
"5-Hydroxyindole-3-acetic acid",
"N-Acetyl-5-hydroxytryptamine",
"2-Picolinic acid",
"Trigonelline",
"Indole-3-propionic acid"
)
aas <- c(
"Glutamic acid",
"Proline",
"Serine",
"Threonine",
"Valine",
"Alanine",
"Aspartic acid",
"Glycine",
"Isoleucine",
"Leucine",
"Phenylalanine")
lcp4 <- c("#95C65C","#B25D91","#FF3F38")
# joined_df <- join_all(sta_lst_sig[c("Hyperglutamatergic","Hypoglutamatergic")], by="group2", type = "full")
joined_df <- sta_lst_sig
joined_df <- subset(joined_df, variable%in%tryp_mets)
vg <- log_df1[log_df1$variable %in% joined_df$variable, ]
colnames(vg) <- c("rowname","Label","variable","log2 Concentration")
vg$Label <- factor(vg$Label, levels=c("1","10","8"))
maxim_val <- apply(df_norm_lab4[, which(colnames(df_norm_lab4)%in%tryp_mets)], 2, max)
maxim_val <- maxim_val + 0.5
joined_df$y.position <- c(sapply(maxim_val, function(x) rep(x,3)))
four4 <- ggboxplot(vg, x = "Label", y = "log2 Concentration", color = "Label", facet.by = "variable", fill = "Label", alpha=0.4) + geom_point(aes(color = vg$Label)) +
facet_wrap(~ variable, scales = "free", ncol = 4) +
stat_pvalue_manual(joined_df, label = "p.adj.signif", y.position = "y.position",hide.ns = TRUE,step.increase = 0.2,bracket.nudge.y = -0.5) +
labs(title = "Alterations in tryptophan metabolism") +
theme(
axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(),plot.background = element_rect(fill = "transparent",colour = NA)
) +
scale_color_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic")) +
scale_fill_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic"))
print(four4)
ggsave(file=here("paper/Figures/4.png"),plot=four4, dpi = 1000,bg="white" ,width = 30, height = 20, units = "cm")
uni1 <- as.grob(four4)
joined_df <- sta_lst_sig
joined_df <- subset(joined_df, variable%in%aas)
vg <- log_df1[log_df1$variable %in% joined_df$variable, ]
colnames(vg) <- c("rowname","Label","variable","log2 Concentration")
vg$Label <- factor(vg$Label, levels=c("1","10","8"))
maxim_val <- apply(df_norm_lab4[, which(colnames(df_norm_lab4)%in%aas)], 2, max)
maxim_val <- maxim_val
joined_df$y.position <- c(sapply(maxim_val, function(x) rep(x,3)))
four4 <- ggboxplot(vg, x = "Label", y = "log2 Concentration", color = "Label", facet.by = "variable", fill = "Label", alpha=0.4) + geom_point(aes(color = vg$Label)) +
facet_wrap(~ variable, scales = "free", ncol = 4) +
stat_pvalue_manual(joined_df, label = "p.adj.signif", y.position = "y.position",hide.ns = TRUE,step.increase = 0.2) +
labs(title = "Other amino acid alterations") +
theme(
axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(),plot.background = element_rect(fill = "transparent",colour = NA)
) +
scale_color_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic")) +
scale_fill_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic"))
print(four4)
ggsave(file=here("paper/Figures/4B.png"),plot=four4, dpi = 1000,bg="white" ,width = 30, height = 20, units = "cm")
uni2 <- as.grob(four4)
joined_df <- sta_lst_sig
joined_df <- subset(joined_df, variable%in%aas)
vg <- log_df1[log_df1$variable %in% joined_df$variable, ]
colnames(vg) <- c("rowname","Label","variable","log2 Concentration")
vg$Label <- factor(vg$Label, levels=c("1","10","8"))
maxim_val <- apply(df_norm_lab4[, which(colnames(df_norm_lab4)%in%aas)], 2, max)
maxim_val <- maxim_val
joined_df$y.position <- c(sapply(maxim_val, function(x) rep(x,3)))
four4 <- ggboxplot(vg, x = "Label", y = "log2 Concentration", color = "Label", facet.by = "variable", fill = "Label", alpha=0.4) + geom_point(aes(color = vg$Label)) +
facet_wrap(~ variable, scales = "free", ncol = 4) +
stat_pvalue_manual(joined_df, label = "p.adj.signif", y.position = "y.position",hide.ns = TRUE,step.increase = 0.2) +
labs(title = "Other amino acid alterations") +
theme(
axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(),plot.background = element_rect(fill = "transparent",colour = NA)
) +
scale_color_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic")) +
scale_fill_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic"))
print(four4)
ggsave(file=here("paper/Figures/4B.png"),plot=four4, dpi = 1000,bg="white" ,width = 30, height = 20, units = "cm")
uni2 <- as.grob(four4)
uni1 / uni2
uni1 + uni2
library(purrr)
library(imputeTS)
library(reshape2)
library(ggpubr)
library(rstatix)
library(ggplot2)
library(ggbiplot)
library(ropls)
library(knitr)
library(factoextra)
library(ggrepel)
library(janitor)
library(patchwork)
library(ggplotify)
library(here)
library(tidyverse)
uni1 + uni2
tryp_mets <- c(
"Kynurenic acid",
"Kynurenine",
"3-Hydroxyanthranilic acid",
"Tryptophan",
"Anthranilic acid",
"5-Hydroxyindole-3-acetic acid",
"N-Acetyl-5-hydroxytryptamine",
"2-Picolinic acid",
"Trigonelline",
"Indole-3-propionic acid"
)
aas <- c(
"Glutamic acid",
"Proline",
"Serine",
"Threonine",
"Valine",
"Alanine",
"Aspartic acid",
"Glycine",
"Isoleucine",
"Leucine",
"Phenylalanine")
lcp4 <- c("#95C65C","#B25D91","#FF3F38")
# joined_df <- join_all(sta_lst_sig[c("Hyperglutamatergic","Hypoglutamatergic")], by="group2", type = "full")
joined_df <- sta_lst_sig
joined_df <- subset(joined_df, variable%in%tryp_mets)
vg <- log_df1[log_df1$variable %in% joined_df$variable, ]
colnames(vg) <- c("rowname","Label","variable","log2 Concentration")
vg$Label <- factor(vg$Label, levels=c("1","10","8"))
maxim_val <- apply(df_norm_lab4[, which(colnames(df_norm_lab4)%in%tryp_mets)], 2, max)
maxim_val <- maxim_val + 0.5
joined_df$y.position <- c(sapply(maxim_val, function(x) rep(x,3)))
four4 <- ggboxplot(vg, x = "Label", y = "log2 Concentration", color = "Label", facet.by = "variable", fill = "Label", alpha=0.4) + geom_point(aes(color = vg$Label)) +
facet_wrap(~ variable, scales = "free", ncol = 4) +
stat_pvalue_manual(joined_df, label = "p.adj.signif", y.position = "y.position",hide.ns = TRUE,step.increase = 0.2,bracket.nudge.y = -0.5) +
labs(title = "Alterations in tryptophan metabolism") +
theme(
axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(),plot.background = element_rect(fill = "transparent",colour = NA)
) +
scale_color_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic")) +
scale_fill_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic"))
print(four4)
ggsave(file=here("paper/Figures/4.png"),plot=four4, dpi = 1000,bg="white" ,width = 30, height = 20, units = "cm")
uni1 <- as.grob(four4)
uni2 <- wrap_elements((as.grob(four4)))
tryp_mets <- c(
"Kynurenic acid",
"Kynurenine",
"3-Hydroxyanthranilic acid",
"Tryptophan",
"Anthranilic acid",
"5-Hydroxyindole-3-acetic acid",
"N-Acetyl-5-hydroxytryptamine",
"2-Picolinic acid",
"Trigonelline",
"Indole-3-propionic acid"
)
aas <- c(
"Glutamic acid",
"Proline",
"Serine",
"Threonine",
"Valine",
"Alanine",
"Aspartic acid",
"Glycine",
"Isoleucine",
"Leucine",
"Phenylalanine")
lcp4 <- c("#95C65C","#B25D91","#FF3F38")
# joined_df <- join_all(sta_lst_sig[c("Hyperglutamatergic","Hypoglutamatergic")], by="group2", type = "full")
joined_df <- sta_lst_sig
joined_df <- subset(joined_df, variable%in%tryp_mets)
vg <- log_df1[log_df1$variable %in% joined_df$variable, ]
colnames(vg) <- c("rowname","Label","variable","log2 Concentration")
vg$Label <- factor(vg$Label, levels=c("1","10","8"))
maxim_val <- apply(df_norm_lab4[, which(colnames(df_norm_lab4)%in%tryp_mets)], 2, max)
maxim_val <- maxim_val + 0.5
joined_df$y.position <- c(sapply(maxim_val, function(x) rep(x,3)))
four4 <- ggboxplot(vg, x = "Label", y = "log2 Concentration", color = "Label", facet.by = "variable", fill = "Label", alpha=0.4) + geom_point(aes(color = vg$Label)) +
facet_wrap(~ variable, scales = "free", ncol = 4) +
stat_pvalue_manual(joined_df, label = "p.adj.signif", y.position = "y.position",hide.ns = TRUE,step.increase = 0.2,bracket.nudge.y = -0.5) +
labs(title = "Alterations in tryptophan metabolism") +
theme(
axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(),plot.background = element_rect(fill = "transparent",colour = NA)
) +
scale_color_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic")) +
scale_fill_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic"))
print(four4)
ggsave(file=here("paper/Figures/4.png"),plot=four4, dpi = 1000,bg="white" ,width = 30, height = 20, units = "cm")
uni1 <- wrap_elements((as.grob(four4)))
joined_df <- sta_lst_sig
joined_df <- subset(joined_df, variable%in%aas)
vg <- log_df1[log_df1$variable %in% joined_df$variable, ]
colnames(vg) <- c("rowname","Label","variable","log2 Concentration")
vg$Label <- factor(vg$Label, levels=c("1","10","8"))
maxim_val <- apply(df_norm_lab4[, which(colnames(df_norm_lab4)%in%aas)], 2, max)
maxim_val <- maxim_val
joined_df$y.position <- c(sapply(maxim_val, function(x) rep(x,3)))
four4 <- ggboxplot(vg, x = "Label", y = "log2 Concentration", color = "Label", facet.by = "variable", fill = "Label", alpha=0.4) + geom_point(aes(color = vg$Label)) +
facet_wrap(~ variable, scales = "free", ncol = 4) +
stat_pvalue_manual(joined_df, label = "p.adj.signif", y.position = "y.position",hide.ns = TRUE,step.increase = 0.2) +
labs(title = "Other amino acid alterations") +
theme(
axis.title.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x = element_blank(),plot.background = element_rect(fill = "transparent",colour = NA)
) +
scale_color_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic")) +
scale_fill_manual(values = lcp4, labels = c("Control","Hyperglutamatergic","Hypoglutamatergic"))
print(four4)
ggsave(file=here("paper/Figures/4B.png"),plot=four4, dpi = 1000,bg="white" ,width = 30, height = 20, units = "cm")
uni2 <- wrap_elements((as.grob(four4)))
uni1 + uni2
uni1 / uni2
